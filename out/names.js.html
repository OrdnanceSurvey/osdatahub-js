<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: names.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: names.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>// src/handlers/names.ts
var __awaiter = (this &amp;&amp; this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
import { coords } from "./utils/coords";
import { request } from "./utils/request";
import { geojson } from "./utils/geojson";
import { buildUrl } from "./utils/url";
import { validateParams } from "./utils/validate";
import { initialiseConfig } from "./utils/config";
export { names };
function requestNames(config) {
    return __awaiter(this, void 0, void 0, function* () {
        let coordsTemp;
        let responseObject = (yield request(config));
        responseObject.results.forEach((result) => {
            coordsTemp = coords.fromBNG(result.GAZETTEER_ENTRY.GEOMETRY_X, result.GAZETTEER_ENTRY.GEOMETRY_Y);
            result.GAZETTEER_ENTRY.LNG = coordsTemp.lng;
            result.GAZETTEER_ENTRY.LAT = coordsTemp.lat;
        });
        return geojson.into(responseObject);
    });
}
const names = {
    /**
     * Get the nearest name to an input coordinate.
     *
     * @param {string} apiKey - A valid OS Data Hub key
     * @param {number[]} point - A Lng/Lat coordinate
     * @return {Promise&lt;OSFeatureCollection>} - A GeoJSON Feature Collection
     */
    nearest: (apiKey, point) => __awaiter(void 0, void 0, void 0, function* () {
        validateParams({ apiKey, point });
        const config = initialiseConfig(apiKey);
        const pointSwivelled = coords.swivelPoint(point);
        const pointBNG = coords.toBNG(pointSwivelled[0], pointSwivelled[1]);
        config.url = buildUrl("names", "nearest", {
            point: `${pointBNG.ea},${pointBNG.no}`,
        });
        config.paging.enabled = false;
        return yield requestNames(config);
    }),
    /**
     * Find names that match a free text search.
     *
     * @param {string} apiKey - A valid OS Data Hub key
     * @param {string} query - Free text search parameter
     * @param {Object} options - Optional arguments
     * @param {number[]} [options.paging] - The start and end offset parameters
     * @return {Promise&lt;OSFeatureCollection>} - A GeoJSON Feature Collection
     */
    find: (apiKey, query, { paging = [0, 1000] } = {}) => __awaiter(void 0, void 0, void 0, function* () {
        validateParams({ apiKey, query });
        const config = initialiseConfig(apiKey, paging);
        config.url = buildUrl("names", "find", { query });
        return yield requestNames(config);
    }),
};
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.11</a> on Wed Oct 05 2022 08:25:21 GMT+0100 (British Summer Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
